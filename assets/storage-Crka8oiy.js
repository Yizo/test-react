import{r as o,I as f,F as c,j as e,R as g,C as d,b5 as R,B as u,a as B,S as v,M as b,s as m}from"./index-C6T66UYw.js";import{T as N,C as h}from"./index-MJq_1bjb.js";import{S as y}from"./index-DpoEN-Oe.js";import{a as D,F as L}from"./Table-rx-uFvO4.js";import{P as V}from"./progress-CgiBRtWq.js";import{S as $}from"./index-gul_2otK.js";import{S as z}from"./index-D3Omcvxu.js";import{D as E}from"./index-S__NQiOU.js";import{R as H}from"./SaveOutlined-zyCnrguJ.js";import{U,R as q}from"./UploadOutlined-CkD0fodu.js";import{R as A}from"./DownloadOutlined-FaP9qsLC.js";import{R as K}from"./DeleteOutlined-CETmvlP7.js";import"./Pagination-B3rYXXPg.js";import"./DeleteOutlined-DFutYCzo.js";import"./DownloadOutlined-DTidZHln.js";var Z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M704 446H320c-4.4 0-8 3.6-8 8v402c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8V454c0-4.4-3.6-8-8-8zm-328 64h272v117H376V510zm272 290H376V683h272v117z"}},{tag:"path",attrs:{d:"M424 748a32 32 0 1064 0 32 32 0 10-64 0zm0-178a32 32 0 1064 0 32 32 0 10-64 0z"}},{tag:"path",attrs:{d:"M811.4 368.9C765.6 248 648.9 162 512.2 162S258.8 247.9 213 368.8C126.9 391.5 63.5 470.2 64 563.6 64.6 668 145.6 752.9 247.6 762c4.7.4 8.7-3.3 8.7-8v-60.4c0-4-3-7.4-7-7.9-27-3.4-52.5-15.2-72.1-34.5-24-23.5-37.2-55.1-37.2-88.6 0-28 9.1-54.4 26.2-76.4 16.7-21.4 40.2-36.9 66.1-43.7l37.9-10 13.9-36.7c8.6-22.8 20.6-44.2 35.7-63.5 14.9-19.2 32.6-36 52.4-50 41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.3c19.9 14 37.5 30.8 52.4 50 15.1 19.3 27.1 40.7 35.7 63.5l13.8 36.6 37.8 10c54.2 14.4 92.1 63.7 92.1 120 0 33.6-13.2 65.1-37.2 88.6-19.5 19.2-44.9 31.1-71.9 34.5-4 .5-6.9 3.9-6.9 7.9V754c0 4.7 4.1 8.4 8.8 8 101.7-9.2 182.5-94 183.2-198.2.6-93.4-62.7-172.1-148.6-194.9z"}}]},name:"cloud-server",theme:"outlined"},J={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},Q={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M296 392h64v64h-64zm0 190v160h128V582h-64v-62h-64v62zm80 48v64h-32v-64h32zm-16-302h64v64h-64zm-64-64h64v64h-64zm64 192h64v64h-64zm0-256h64v64h-64zm494.6 88.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h64v64h64v-64h174v216a42 42 0 0042 42h216v494z"}}]},name:"file-zip",theme:"outlined"};function C(){return C=Object.assign?Object.assign.bind():function(a){for(var s=1;s<arguments.length;s++){var l=arguments[s];for(var n in l)Object.prototype.hasOwnProperty.call(l,n)&&(a[n]=l[n])}return a},C.apply(this,arguments)}const W=(a,s)=>o.createElement(f,C({},a,{ref:s,icon:Z})),X=o.forwardRef(W);function w(){return w=Object.assign?Object.assign.bind():function(a){for(var s=1;s<arguments.length;s++){var l=arguments[s];for(var n in l)Object.prototype.hasOwnProperty.call(l,n)&&(a[n]=l[n])}return a},w.apply(this,arguments)}const Y=(a,s)=>o.createElement(f,w({},a,{ref:s,icon:J})),ee=o.forwardRef(Y);function S(){return S=Object.assign?Object.assign.bind():function(a){for(var s=1;s<arguments.length;s++){var l=arguments[s];for(var n in l)Object.prototype.hasOwnProperty.call(l,n)&&(a[n]=l[n])}return a},S.apply(this,arguments)}const se=(a,s)=>o.createElement(f,S({},a,{ref:s,icon:Q})),te=o.forwardRef(se);function O(){return O=Object.assign?Object.assign.bind():function(a){for(var s=1;s<arguments.length;s++){var l=arguments[s];for(var n in l)Object.prototype.hasOwnProperty.call(l,n)&&(a[n]=l[n])}return a},O.apply(this,arguments)}const ae=(a,s)=>o.createElement(f,O({},a,{ref:s,icon:D})),ne=o.forwardRef(ae),{Option:x}=$,{TabPane:k}=N,be=()=>{const[a]=c.useForm(),[s,l]=o.useState(!1),[n,j]=o.useState([{id:"1",name:"system_backup_20240115",size:"2.3 GB",createTime:"2024-01-15 10:30:00",type:"full",status:"completed"},{id:"2",name:"config_backup_20240110",size:"45.2 MB",createTime:"2024-01-10 15:20:00",type:"config",status:"completed"},{id:"3",name:"logs_backup_20240105",size:"1.8 GB",createTime:"2024-01-05 09:15:00",type:"logs",status:"completed"}]),p={total:500,used:186,available:314,usagePercent:37},I=[{key:"system",label:"系统日志",size:"3.2 GB",retention:90},{key:"application",label:"应用日志",size:"12.5 GB",retention:30},{key:"error",label:"错误日志",size:"2.8 GB",retention:180},{key:"access",label:"访问日志",size:"45.6 GB",retention:7},{key:"audit",label:"审计日志",size:"8.1 GB",retention:365}],M=async t=>{l(!0);try{console.log("保存存储配置:",t),await new Promise(r=>setTimeout(r,1e3)),m.success("存储配置保存成功")}catch{m.error("保存失败")}finally{l(!1)}},T=()=>{b.confirm({title:"创建备份",content:"确定要创建系统备份吗？此操作可能需要一些时间。",onOk:()=>{const t={id:Date.now().toString(),name:`system_backup_${new Date().toISOString().split("T")[0].replace(/-/g,"")}`,size:"计算中...",createTime:new Date().toLocaleString(),type:"full",status:"creating"};j([t,...n]),m.success("备份任务已启动"),setTimeout(()=>{j(r=>r.map(i=>i.id===t.id?{...i,size:"2.5 GB",status:"completed"}:i)),m.success("备份创建完成")},3e3)}})},P=t=>{m.success(`开始下载备份文件: ${t.name}`)},_=t=>{b.confirm({title:"删除备份",content:"确定要删除这个备份文件吗？删除后不可恢复。",icon:e.jsx(ee,{}),onOk:()=>{j(n.filter(r=>r.id!==t)),m.success("备份文件删除成功")}})},F=t=>{var r;b.confirm({title:"清理日志",content:`确定要清理 ${(r=I.find(i=>i.key===t))==null?void 0:r.label} 吗？`,onOk:()=>{m.success("日志清理完成")}})},G=[{title:"备份名称",dataIndex:"name",key:"name",render:(t,r)=>e.jsxs(v,{children:[e.jsx(te,{}),t]})},{title:"类型",dataIndex:"type",key:"type",render:t=>{const i={full:{label:"完整备份",color:"blue"},config:{label:"配置备份",color:"green"},logs:{label:"日志备份",color:"orange"}}[t];return e.jsx("span",{className:`px-2 py-1 rounded text-xs bg-${i.color}-100 text-${i.color}-800`,children:i.label})}},{title:"大小",dataIndex:"size",key:"size"},{title:"创建时间",dataIndex:"createTime",key:"createTime"},{title:"状态",dataIndex:"status",key:"status",render:t=>{const i={completed:{label:"已完成",color:"green"},creating:{label:"创建中",color:"blue"},failed:{label:"失败",color:"red"}}[t];return e.jsx("span",{className:`px-2 py-1 rounded text-xs bg-${i.color}-100 text-${i.color}-800`,children:i.label})}},{title:"操作",key:"action",render:(t,r)=>e.jsxs(v,{children:[e.jsx(u,{type:"link",size:"small",icon:e.jsx(A,{}),onClick:()=>P(r),disabled:r.status!=="completed",children:"下载"}),e.jsx(u,{type:"link",size:"small",danger:!0,icon:e.jsx(K,{}),onClick:()=>_(r.id),children:"删除"})]})}];return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-2",children:"日志与存储"}),e.jsx("p",{className:"text-gray-600",children:"管理系统日志、存储配置和数据备份"})]}),e.jsxs(N,{defaultActiveKey:"storage",children:[e.jsxs(k,{tab:"存储概览",children:[e.jsxs(g,{gutter:[16,16],children:[e.jsx(d,{xs:24,lg:8,children:e.jsx(h,{children:e.jsx(y,{title:"总存储空间",value:p.total,suffix:"GB",prefix:e.jsx(R,{})})})}),e.jsx(d,{xs:24,lg:8,children:e.jsx(h,{children:e.jsx(y,{title:"已使用",value:p.used,suffix:"GB",valueStyle:{color:"#1890ff"},prefix:e.jsx(ne,{})})})}),e.jsx(d,{xs:24,lg:8,children:e.jsx(h,{children:e.jsx(y,{title:"可用空间",value:p.available,suffix:"GB",valueStyle:{color:"#52c41a"},prefix:e.jsx(X,{})})})})]}),e.jsxs(h,{title:"存储使用情况",className:"mt-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{children:"存储使用率"}),e.jsxs("span",{children:[p.usagePercent,"%"]})]}),e.jsx(V,{percent:p.usagePercent,status:"active",strokeColor:"#1890ff"})]}),e.jsx("div",{className:"space-y-3",children:I.map(t=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.label}),e.jsxs("div",{className:"text-sm text-gray-500",children:["保留期: ",t.retention," 天"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-medium",children:t.size}),e.jsx(u,{type:"link",size:"small",danger:!0,onClick:()=>F(t.key),children:"清理"})]})]},t.key))})]})]},"storage"),e.jsx(k,{tab:"日志配置",children:e.jsx(h,{children:e.jsxs(c,{form:a,layout:"vertical",onFinish:M,initialValues:{logLevel:"info",retentionDays:30,maxFileSize:100,autoCleanup:!0,compress:!0,enableRemoteLog:!1},children:[e.jsxs(g,{gutter:16,children:[e.jsx(d,{span:12,children:e.jsx(c.Item,{label:"日志级别",name:"logLevel",rules:[{required:!0,message:"请选择日志级别"}],children:e.jsxs($,{placeholder:"请选择日志级别",children:[e.jsx(x,{value:"debug",children:"Debug - 调试信息"}),e.jsx(x,{value:"info",children:"Info - 一般信息"}),e.jsx(x,{value:"warn",children:"Warn - 警告信息"}),e.jsx(x,{value:"error",children:"Error - 错误信息"})]})})}),e.jsx(d,{span:12,children:e.jsx(c.Item,{label:"日志保留天数",name:"retentionDays",rules:[{required:!0,message:"请输入保留天数"}],children:e.jsx(B,{addonAfter:"天",placeholder:"请输入保留天数"})})})]}),e.jsxs(g,{gutter:16,children:[e.jsx(d,{span:12,children:e.jsx(c.Item,{label:"单个日志文件最大大小",name:"maxFileSize",rules:[{required:!0,message:"请输入最大文件大小"}],children:e.jsx(B,{addonAfter:"MB",placeholder:"请输入最大文件大小"})})}),e.jsx(d,{span:12,children:e.jsx(c.Item,{label:"功能开关",children:e.jsxs(v,{direction:"vertical",className:"w-full",children:[e.jsxs(c.Item,{name:"autoCleanup",valuePropName:"checked",noStyle:!0,children:[e.jsx(z,{checkedChildren:"开启",unCheckedChildren:"关闭"}),e.jsx("span",{className:"ml-2",children:"自动清理过期日志"})]}),e.jsxs(c.Item,{name:"compress",valuePropName:"checked",noStyle:!0,children:[e.jsx(z,{checkedChildren:"开启",unCheckedChildren:"关闭"}),e.jsx("span",{className:"ml-2",children:"压缩存储"})]}),e.jsxs(c.Item,{name:"enableRemoteLog",valuePropName:"checked",noStyle:!0,children:[e.jsx(z,{checkedChildren:"开启",unCheckedChildren:"关闭"}),e.jsx("span",{className:"ml-2",children:"远程日志同步"})]})]})})})]}),e.jsx(E,{}),e.jsx(c.Item,{children:e.jsx(u,{type:"primary",htmlType:"submit",icon:e.jsx(H,{}),loading:s,children:"保存配置"})})]})})},"logs"),e.jsx(k,{tab:"备份管理",children:e.jsxs(h,{children:[e.jsxs("div",{className:"mb-4 flex justify-between items-center",children:[e.jsx("div",{children:e.jsx(u,{type:"primary",icon:e.jsx(R,{}),onClick:T,children:"创建备份"})}),e.jsx("div",{children:e.jsx(U,{accept:".zip,.tar.gz",showUploadList:!1,beforeUpload:()=>!1,children:e.jsx(u,{icon:e.jsx(q,{}),children:"恢复备份"})})})]}),e.jsx(L,{columns:G,dataSource:n,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:t=>`共 ${t} 条记录`}})]})},"backup")]})]})};export{be as default};
