import{u as V,r as l,F as n,j as e,S as g,a as p,B as i,M as C,s as c,b as G}from"./index-C6T66UYw.js";import{m as L}from"./mock-CsnfvyZD.js";import{C as q}from"./index-MJq_1bjb.js";import{S as r}from"./index-gul_2otK.js";import{R as H}from"./PlusOutlined-DadAM9jt.js";import{F as W}from"./Table-rx-uFvO4.js";import{T as b}from"./index-BWL1JphO.js";import{R as _}from"./EyeOutlined-DnSgRtn5.js";import{R as J}from"./EditOutlined-9U3olPbu.js";import{P as N}from"./index-C-4xovFz.js";import{R as Q}from"./DeleteOutlined-CETmvlP7.js";import"./Pagination-B3rYXXPg.js";import"./EditOutlined-DdmGLkPL.js";import"./DeleteOutlined-DFutYCzo.js";const{Search:U}=p,{Option:a}=r,he=()=>{const f=V(),[o,d]=l.useState(L),[T]=l.useState(!1),[h,w]=l.useState([]),[x,S]=l.useState(""),[y,R]=l.useState(""),[v,A]=l.useState(""),[F,u]=l.useState(!1),[j,I]=l.useState(null),[m]=n.useForm(),K=[{title:"AppKey",dataIndex:"appKey",key:"appKey",width:150,render:t=>e.jsx("code",{children:t})},{title:"应用名称",dataIndex:"name",key:"name"},{title:"负责人",dataIndex:"owner",key:"owner"},{title:"分组",dataIndex:"group",key:"group"},{title:"标签",dataIndex:"tags",key:"tags",render:t=>e.jsx(e.Fragment,{children:t.map(s=>e.jsx(b,{color:"blue",children:s},s))})},{title:"状态",dataIndex:"status",key:"status",render:t=>e.jsx(b,{color:t==="active"?"green":"red",children:t==="active"?"启用":"禁用"})},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:180},{title:"操作",key:"action",width:220,render:(t,s)=>e.jsxs(g,{size:"small",children:[e.jsx(i,{size:"small",icon:e.jsx(_,{}),onClick:()=>f(`/apps/${s.id}`),children:"详情"}),e.jsx(i,{size:"small",icon:e.jsx(J,{}),onClick:()=>M(s),children:"编辑"}),e.jsx(i,{size:"small",icon:e.jsx(G,{}),onClick:()=>f(`/configs?appKey=${s.appKey}`),children:"配置监控"}),e.jsx(N,{title:"确定删除这个应用吗？",onConfirm:()=>z(s.id),okText:"确定",cancelText:"取消",children:e.jsx(i,{size:"small",danger:!0,icon:e.jsx(Q,{}),children:"删除"})})]})}],$=()=>{I(null),m.resetFields(),u(!0)},M=t=>{I(t),m.setFieldsValue(t),u(!0)},z=t=>{d(o.filter(s=>s.id!==t)),c.success("删除成功")},D=()=>{if(h.length===0){c.warning("请选择要删除的应用");return}C.confirm({title:"批量删除",content:`确定删除选中的 ${h.length} 个应用吗？`,onOk:()=>{d(o.filter(t=>!h.includes(t.id))),w([]),c.success("批量删除成功")}})},B=()=>{m.validateFields().then(t=>{if(j)d(o.map(s=>s.id===j.id?{...s,...t,updateTime:new Date().toLocaleString()}:s)),c.success("编辑成功");else{const s={id:Date.now().toString(),appKey:`app_${Date.now()}`,...t,createTime:new Date().toLocaleString(),updateTime:new Date().toLocaleString()};d([...o,s]),c.success("新增成功")}u(!1)})},k=o.filter(t=>{const s=t.name.includes(x)||t.appKey.includes(x)||t.owner.includes(x),E=!y||t.group===y,O=!v||t.status===v;return s&&E&&O}),P={selectedRowKeys:h,onChange:t=>{w(t)}};return e.jsxs(q,{children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs(g,{style:{marginBottom:16},children:[e.jsx(U,{placeholder:"搜索应用名称、AppKey、负责人",allowClear:!0,style:{width:300},onSearch:S,onChange:t=>S(t.target.value)}),e.jsxs(r,{placeholder:"选择分组",allowClear:!0,style:{width:150},onChange:R,children:[e.jsx(a,{value:"官网项目",children:"官网项目"}),e.jsx(a,{value:"移动项目",children:"移动项目"})]}),e.jsxs(r,{placeholder:"选择状态",allowClear:!0,style:{width:120},onChange:A,children:[e.jsx(a,{value:"active",children:"启用"}),e.jsx(a,{value:"inactive",children:"禁用"})]})]}),e.jsx("div",{children:e.jsxs(g,{children:[e.jsx(i,{type:"primary",icon:e.jsx(H,{}),onClick:$,children:"新增应用"}),e.jsx(i,{danger:!0,onClick:D,children:"批量删除"})]})})]}),e.jsx(W,{rowSelection:P,columns:K,dataSource:k,rowKey:"id",loading:T,pagination:{total:k.length,pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:t=>`共 ${t} 条记录`}}),e.jsx(C,{title:j?"编辑应用":"新增应用",open:F,onOk:B,onCancel:()=>u(!1),width:600,children:e.jsxs(n,{form:m,layout:"vertical",children:[e.jsx(n.Item,{name:"name",label:"应用名称",rules:[{required:!0,message:"请输入应用名称"}],children:e.jsx(p,{placeholder:"请输入应用名称"})}),e.jsx(n.Item,{name:"owner",label:"负责人",rules:[{required:!0,message:"请输入负责人"}],children:e.jsx(p,{placeholder:"请输入负责人"})}),e.jsx(n.Item,{name:"group",label:"分组",children:e.jsxs(r,{placeholder:"请选择分组",children:[e.jsx(a,{value:"官网项目",children:"官网项目"}),e.jsx(a,{value:"移动项目",children:"移动项目"})]})}),e.jsx(n.Item,{name:"tags",label:"标签",children:e.jsxs(r,{mode:"tags",placeholder:"请输入标签",children:[e.jsx(a,{value:"Web",children:"Web"}),e.jsx(a,{value:"Mobile",children:"Mobile"}),e.jsx(a,{value:"PC",children:"PC"}),e.jsx(a,{value:"H5",children:"H5"})]})}),e.jsx(n.Item,{name:"description",label:"描述",children:e.jsx(p.TextArea,{rows:3,placeholder:"请输入应用描述"})}),e.jsx(n.Item,{name:"status",label:"状态",initialValue:"active",children:e.jsxs(r,{children:[e.jsx(a,{value:"active",children:"启用"}),e.jsx(a,{value:"inactive",children:"禁用"})]})})]})})]})};export{he as default};
