import{r as a,j as e,S as k,a as P,B as p,M as R}from"./index-C6T66UYw.js";import{C as O}from"./index-MJq_1bjb.js";import{S as x}from"./index-gul_2otK.js";import{D as C}from"./index-B-3zsT62.js";import{R as M}from"./ExportOutlined-J_0Br3tR.js";import{F as E}from"./Table-rx-uFvO4.js";import{D as l}from"./index-Dekj6dpf.js";import{T as o}from"./index-BWL1JphO.js";import{R as z}from"./EyeOutlined-DnSgRtn5.js";import"./ClockCircleOutlined-CELcQ7Uv.js";import"./Pagination-B3rYXXPg.js";const W=[{id:"1",operatorName:"张三",operatorId:"user_001",operationType:"创建应用",targetType:"应用",targetName:"官网前端",targetId:"app_web_001",operationTime:"2024-01-20 14:30:00",ipAddress:"192.168.1.100",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",operationDetail:"创建新应用：官网前端，AppKey: app_web_001",result:"success"},{id:"2",operatorName:"李四",operatorId:"user_002",operationType:"编辑配置",targetType:"监控配置",targetName:"移动端监控配置 v1.1.0",targetId:"config_002",operationTime:"2024-01-20 10:15:00",ipAddress:"192.168.1.101",userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36",operationDetail:"修改采样率从100%调整为80%，关闭行为监控",result:"success"},{id:"3",operatorName:"王五",operatorId:"user_003",operationType:"删除告警规则",targetType:"告警规则",targetName:"高响应时间",targetId:"alert_rule_003",operationTime:"2024-01-18 09:30:00",ipAddress:"192.168.1.102",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",operationDetail:"删除高响应时间告警规则",result:"failed",errorMsg:"无权限操作"}],u={创建应用:{text:"创建应用",color:"green"},编辑应用:{text:"编辑应用",color:"blue"},删除应用:{text:"删除应用",color:"red"},编辑配置:{text:"编辑配置",color:"orange"},发布配置:{text:"发布配置",color:"purple"},删除告警规则:{text:"删除告警规则",color:"red"},创建成员:{text:"创建成员",color:"green"},编辑权限:{text:"编辑权限",color:"blue"}},L=[{value:"创建应用",label:"创建应用"},{value:"编辑应用",label:"编辑应用"},{value:"删除应用",label:"删除应用"},{value:"编辑配置",label:"编辑配置"},{value:"发布配置",label:"发布配置"},{value:"删除告警规则",label:"删除告警规则"},{value:"创建成员",label:"创建成员"},{value:"编辑权限",label:"编辑权限"}],j={success:{text:"成功",color:"green"},failed:{text:"失败",color:"red"}},K=[{value:"success",label:"成功"},{value:"failed",label:"失败"}],{Search:B}=P,{Option:T}=x,{RangePicker:F}=C,ee=()=>{var g;const[I]=a.useState(W),[b]=a.useState(!1),[s,m]=a.useState(""),[i,y]=a.useState(""),[n,f]=a.useState(""),[r,v]=a.useState(null),[S,c]=a.useState(!1),w=[{title:"操作时间",dataIndex:"operationTime",key:"operationTime",width:180,sorter:(t,d)=>new Date(t.operationTime).getTime()-new Date(d.operationTime).getTime()},{title:"操作人",key:"operator",render:t=>e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:500},children:t.operatorName}),e.jsx("div",{style:{fontSize:"12px",color:"#666"},children:t.operatorId})]})},{title:"操作类型",dataIndex:"operationType",key:"operationType",render:t=>e.jsx(o,{color:u[t].color,children:u[t].text})},{title:"操作对象",key:"target",render:t=>e.jsxs("div",{children:[e.jsx("div",{children:t.targetName}),e.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:[t.targetType," | ",t.targetId]})]})},{title:"操作结果",dataIndex:"result",key:"result",render:t=>e.jsx(o,{color:j[t].color,children:j[t].text})},{title:"IP地址",dataIndex:"ipAddress",key:"ipAddress",width:140},{title:"操作详情",dataIndex:"operationDetail",key:"operationDetail",ellipsis:!0},{title:"操作",key:"action",width:100,render:t=>e.jsx(p,{size:"small",icon:e.jsx(z,{}),onClick:()=>A(t),children:"详情"})}],A=t=>{v(t),c(!0)},N=()=>{console.log("导出操作日志")},h=I.filter(t=>{const d=t.operatorName.includes(s)||t.targetName.includes(s)||t.operationDetail.includes(s),_=!i||t.operationType===i,D=!n||t.result===n;return d&&_&&D});return e.jsxs(O,{children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs(k,{style:{marginBottom:16},children:[e.jsx(B,{placeholder:"搜索操作人、对象、详情",allowClear:!0,style:{width:300},onSearch:m,onChange:t=>m(t.target.value)}),e.jsx(x,{placeholder:"操作类型",style:{width:150},value:i,onChange:y,allowClear:!0,children:L.map(t=>e.jsx(T,{value:t.value,children:t.label},t.value))}),e.jsx(x,{placeholder:"操作结果",style:{width:100},value:n,onChange:f,allowClear:!0,children:K.map(t=>e.jsx(T,{value:t.value,children:t.label},t.value))}),e.jsx(F,{placeholder:["开始时间","结束时间"]})]}),e.jsx("div",{children:e.jsx(p,{icon:e.jsx(M,{}),onClick:N,children:"导出日志"})})]}),e.jsx(E,{columns:w,dataSource:h,rowKey:"id",loading:b,pagination:{total:h.length,pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:t=>`共 ${t} 条记录`}}),e.jsx(R,{title:"操作日志详情",open:S,onCancel:()=>c(!1),footer:[e.jsx(p,{onClick:()=>c(!1),children:"关闭"},"close")],width:800,children:r&&e.jsxs(l,{column:2,bordered:!0,children:[e.jsx(l.Item,{label:"操作时间",span:2,children:r.operationTime}),e.jsx(l.Item,{label:"操作人",children:r.operatorName}),e.jsx(l.Item,{label:"用户ID",children:r.operatorId}),e.jsx(l.Item,{label:"操作类型",children:e.jsx(o,{color:((g=u[r.operationType])==null?void 0:g.color)||"default",children:r.operationType})}),e.jsx(l.Item,{label:"操作结果",children:e.jsx(o,{color:r.result==="success"?"green":"red",children:r.result==="success"?"成功":"失败"})}),e.jsx(l.Item,{label:"对象类型",children:r.targetType}),e.jsx(l.Item,{label:"对象名称",children:r.targetName}),e.jsx(l.Item,{label:"对象ID",span:2,children:e.jsx("code",{children:r.targetId})}),e.jsx(l.Item,{label:"IP地址",children:r.ipAddress}),e.jsx(l.Item,{label:"User Agent",span:2,children:r.userAgent}),e.jsx(l.Item,{label:"操作详情",span:2,children:r.operationDetail}),r.errorMsg&&e.jsx(l.Item,{label:"错误信息",span:2,children:e.jsx("span",{style:{color:"#ff4d4f"},children:r.errorMsg})})]})})]})};export{ee as default};
