import{r as d,I as A,F as s,j as e,R as S,C as p,a as o,S as x,B as j,M as C,s as m,a5 as E}from"./index-C6T66UYw.js";import{T as F,C as O}from"./index-MJq_1bjb.js";import{S as f}from"./index-gul_2otK.js";import{S as v}from"./index-D3Omcvxu.js";import{D as P}from"./index-S__NQiOU.js";import{R as _}from"./SaveOutlined-zyCnrguJ.js";import{R as V}from"./PlusOutlined-DadAM9jt.js";import{F as K}from"./Table-rx-uFvO4.js";import{T as R}from"./index-BWL1JphO.js";import{R as B}from"./EditOutlined-9U3olPbu.js";import{R as U}from"./DeleteOutlined-CETmvlP7.js";import"./Pagination-B3rYXXPg.js";import"./EditOutlined-DdmGLkPL.js";import"./DeleteOutlined-DFutYCzo.js";var G={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M608 112c-167.9 0-304 136.1-304 304 0 70.3 23.9 135 63.9 186.5l-41.1 41.1-62.3-62.3a8.15 8.15 0 00-11.4 0l-39.8 39.8a8.15 8.15 0 000 11.4l62.3 62.3-44.9 44.9-62.3-62.3a8.15 8.15 0 00-11.4 0l-39.8 39.8a8.15 8.15 0 000 11.4l62.3 62.3-65.3 65.3a8.03 8.03 0 000 11.3l42.3 42.3c3.1 3.1 8.2 3.1 11.3 0l253.6-253.6A304.06 304.06 0 00608 720c167.9 0 304-136.1 304-304S775.9 112 608 112zm161.2 465.2C726.2 620.3 668.9 644 608 644c-60.9 0-118.2-23.7-161.2-66.8-43.1-43-66.8-100.3-66.8-161.2 0-60.9 23.7-118.2 66.8-161.2 43-43.1 100.3-66.8 161.2-66.8 60.9 0 118.2 23.7 161.2 66.8 43.1 43 66.8 100.3 66.8 161.2 0 60.9-23.7 118.2-66.8 161.2z"}}]},name:"key",theme:"outlined"},H={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M866.9 169.9L527.1 54.1C523 52.7 517.5 52 512 52s-11 .7-15.1 2.1L157.1 169.9c-8.3 2.8-15.1 12.4-15.1 21.2v482.4c0 8.8 5.7 20.4 12.6 25.9L499.3 968c3.5 2.7 8 4.1 12.6 4.1s9.2-1.4 12.6-4.1l344.7-268.6c6.9-5.4 12.6-17 12.6-25.9V191.1c.2-8.8-6.6-18.3-14.9-21.2zM810 654.3L512 886.5 214 654.3V226.7l298-101.6 298 101.6v427.6zM402.9 528.8l-77.5 77.5a8.03 8.03 0 000 11.3l34 34c3.1 3.1 8.2 3.1 11.3 0l77.5-77.5c55.7 35.1 130.1 28.4 178.6-20.1 56.3-56.3 56.3-147.5 0-203.8-56.3-56.3-147.5-56.3-203.8 0-48.5 48.5-55.2 123-20.1 178.6zm65.4-133.3c31.3-31.3 82-31.3 113.2 0 31.3 31.3 31.3 82 0 113.2-31.3 31.3-82 31.3-113.2 0s-31.3-81.9 0-113.2z"}}]},name:"security-scan",theme:"outlined"};function y(){return y=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var i=arguments[r];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},y.apply(this,arguments)}const J=(t,r)=>d.createElement(A,y({},t,{ref:r,icon:G})),Q=d.forwardRef(J);function I(){return I=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var i=arguments[r];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},I.apply(this,arguments)}const W=(t,r)=>d.createElement(A,I({},t,{ref:r,icon:H})),X=d.forwardRef(W),{Option:c}=f,{TextArea:Y}=o,{TabPane:N}=F,ue=()=>{const[t]=s.useForm(),[r]=s.useForm(),[i,n]=d.useState(!1),[M,h]=d.useState(!1),[g,w]=d.useState(null),[u,b]=d.useState([{id:"1",name:"本地认证",type:"local",status:"enabled",config:{},description:"系统内置的用户名密码认证"},{id:"2",name:"企业微信",type:"wechat_work",status:"disabled",config:{corpId:"",corpSecret:"",agentId:""},description:"通过企业微信进行单点登录"},{id:"3",name:"钉钉",type:"dingtalk",status:"disabled",config:{appKey:"",appSecret:""},description:"通过钉钉进行单点登录"}]),T=async l=>{n(!0);try{console.log("保存认证配置:",l),await new Promise(a=>setTimeout(a,1e3)),m.success("认证配置保存成功")}catch{m.error("保存失败")}finally{n(!1)}},L=()=>{w(null),r.resetFields(),h(!0)},$=l=>{w(l),r.setFieldsValue(l),h(!0)},q=l=>{C.confirm({title:"确认删除",content:"确定要删除这个认证提供方吗？",onOk:()=>{b(u.filter(a=>a.id!==l)),m.success("删除成功")}})},z=async()=>{try{const l=await r.validateFields();if(g)b(u.map(a=>a.id===g.id?{...a,...l}:a)),m.success("更新成功");else{const a={id:Date.now().toString(),...l};b([...u,a]),m.success("添加成功")}h(!1)}catch(l){console.error("表单验证失败:",l)}},D=[{title:"名称",dataIndex:"name",key:"name",render:(l,a)=>e.jsxs(x,{children:[a.type==="local"&&e.jsx(E,{}),a.type==="wechat_work"&&e.jsx(X,{}),a.type==="dingtalk"&&e.jsx(Q,{}),l]})},{title:"类型",dataIndex:"type",key:"type",render:l=>{const k={local:{label:"本地认证",color:"blue"},wechat_work:{label:"企业微信",color:"green"},dingtalk:{label:"钉钉",color:"orange"},oauth:{label:"OAuth2",color:"purple"}}[l]||{label:l,color:"default"};return e.jsx(R,{color:k.color,children:k.label})}},{title:"状态",dataIndex:"status",key:"status",render:l=>e.jsx(R,{color:l==="enabled"?"success":"default",children:l==="enabled"?"已启用":"已禁用"})},{title:"描述",dataIndex:"description",key:"description"},{title:"操作",key:"action",render:(l,a)=>e.jsxs(x,{children:[e.jsx(j,{type:"link",size:"small",icon:e.jsx(B,{}),onClick:()=>$(a),children:"编辑"}),a.type!=="local"&&e.jsx(j,{type:"link",size:"small",danger:!0,icon:e.jsx(U,{}),onClick:()=>q(a.id),children:"删除"})]})}];return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-2",children:"登录认证"}),e.jsx("p",{className:"text-gray-600",children:"配置系统登录方式和第三方认证"})]}),e.jsxs(F,{defaultActiveKey:"basic",children:[e.jsx(N,{tab:"基础配置",children:e.jsx(O,{children:e.jsxs(s,{form:t,layout:"vertical",onFinish:T,initialValues:{sessionTimeout:720,passwordStrength:"medium",multiLogin:!1,rememberLogin:!0,captchaEnabled:!0,loginAttempts:5},children:[e.jsxs(S,{gutter:16,children:[e.jsx(p,{span:12,children:e.jsx(s.Item,{label:"会话超时时间",name:"sessionTimeout",rules:[{required:!0,message:"请输入会话超时时间"}],children:e.jsx(o,{addonAfter:"分钟",placeholder:"请输入会话超时时间"})})}),e.jsx(p,{span:12,children:e.jsx(s.Item,{label:"密码强度要求",name:"passwordStrength",rules:[{required:!0,message:"请选择密码强度要求"}],children:e.jsxs(f,{placeholder:"请选择密码强度要求",children:[e.jsx(c,{value:"low",children:"低 - 仅要求6位以上"}),e.jsx(c,{value:"medium",children:"中 - 字母+数字，8位以上"}),e.jsx(c,{value:"high",children:"高 - 字母+数字+符号，10位以上"})]})})})]}),e.jsxs(S,{gutter:16,children:[e.jsx(p,{span:12,children:e.jsx(s.Item,{label:"登录失败次数限制",name:"loginAttempts",rules:[{required:!0,message:"请输入登录失败次数限制"}],children:e.jsx(o,{placeholder:"请输入登录失败次数限制"})})}),e.jsx(p,{span:12,children:e.jsx(s.Item,{label:"功能开关",name:"switches",children:e.jsxs(x,{direction:"vertical",className:"w-full",children:[e.jsxs(s.Item,{name:"multiLogin",valuePropName:"checked",noStyle:!0,children:[e.jsx(v,{checkedChildren:"开启",unCheckedChildren:"关闭"}),e.jsx("span",{className:"ml-2",children:"允许多地登录"})]}),e.jsxs(s.Item,{name:"rememberLogin",valuePropName:"checked",noStyle:!0,children:[e.jsx(v,{checkedChildren:"开启",unCheckedChildren:"关闭"}),e.jsx("span",{className:"ml-2",children:"记住登录状态"})]}),e.jsxs(s.Item,{name:"captchaEnabled",valuePropName:"checked",noStyle:!0,children:[e.jsx(v,{checkedChildren:"开启",unCheckedChildren:"关闭"}),e.jsx("span",{className:"ml-2",children:"启用验证码"})]})]})})})]}),e.jsx(P,{}),e.jsx(s.Item,{children:e.jsx(x,{children:e.jsx(j,{type:"primary",htmlType:"submit",icon:e.jsx(_,{}),loading:i,children:"保存配置"})})})]})})},"basic"),e.jsx(N,{tab:"第三方认证",children:e.jsxs(O,{children:[e.jsx("div",{className:"mb-4",children:e.jsx(j,{type:"primary",icon:e.jsx(V,{}),onClick:L,children:"添加认证提供方"})}),e.jsx(K,{columns:D,dataSource:u,rowKey:"id",pagination:!1})]})},"providers")]}),e.jsx(C,{title:g?"编辑认证提供方":"添加认证提供方",open:M,onOk:z,onCancel:()=>h(!1),width:600,children:e.jsxs(s,{form:r,layout:"vertical",children:[e.jsx(s.Item,{label:"名称",name:"name",rules:[{required:!0,message:"请输入名称"}],children:e.jsx(o,{placeholder:"请输入认证提供方名称"})}),e.jsx(s.Item,{label:"类型",name:"type",rules:[{required:!0,message:"请选择类型"}],children:e.jsxs(f,{placeholder:"请选择认证类型",children:[e.jsx(c,{value:"oauth",children:"OAuth2"}),e.jsx(c,{value:"wechat_work",children:"企业微信"}),e.jsx(c,{value:"dingtalk",children:"钉钉"}),e.jsx(c,{value:"ldap",children:"LDAP"})]})}),e.jsx(s.Item,{label:"状态",name:"status",rules:[{required:!0,message:"请选择状态"}],children:e.jsxs(f,{placeholder:"请选择状态",children:[e.jsx(c,{value:"enabled",children:"启用"}),e.jsx(c,{value:"disabled",children:"禁用"})]})}),e.jsx(s.Item,{label:"描述",name:"description",children:e.jsx(Y,{rows:3,placeholder:"请输入描述信息"})}),e.jsx(P,{children:"配置参数"}),e.jsx(s.Item,{label:"客户端ID",name:["config","clientId"],rules:[{required:!0,message:"请输入客户端ID"}],children:e.jsx(o,{placeholder:"请输入客户端ID"})}),e.jsx(s.Item,{label:"客户端密钥",name:["config","clientSecret"],rules:[{required:!0,message:"请输入客户端密钥"}],children:e.jsx(o.Password,{placeholder:"请输入客户端密钥"})}),e.jsx(s.Item,{label:"授权地址",name:["config","authUrl"],children:e.jsx(o,{placeholder:"请输入授权地址"})}),e.jsx(s.Item,{label:"令牌地址",name:["config","tokenUrl"],children:e.jsx(o,{placeholder:"请输入令牌地址"})}),e.jsx(s.Item,{label:"用户信息地址",name:["config","userInfoUrl"],children:e.jsx(o,{placeholder:"请输入用户信息地址"})})]})})]})};export{ue as default};
