import{r as s,I as B,F as c,j as t,S as g,a as S,B as d,M as j,s as b}from"./index-C6T66UYw.js";import{C as _}from"./index-MJq_1bjb.js";import{R as K}from"./PlusOutlined-DadAM9jt.js";import{F as q,T as I}from"./Table-rx-uFvO4.js";import{S as N}from"./index-D3Omcvxu.js";import{D as U}from"./index-S__NQiOU.js";import{T as p}from"./index-BWL1JphO.js";import{R as H}from"./EditOutlined-9U3olPbu.js";import{R as J}from"./DeleteOutlined-CETmvlP7.js";import"./index-gul_2otK.js";import"./Pagination-B3rYXXPg.js";import"./EditOutlined-DdmGLkPL.js";import"./DeleteOutlined-DFutYCzo.js";var Q={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M866.9 169.9L527.1 54.1C523 52.7 517.5 52 512 52s-11 .7-15.1 2.1L157.1 169.9c-8.3 2.8-15.1 12.4-15.1 21.2v482.4c0 8.8 5.7 20.4 12.6 25.9L499.3 968c3.5 2.7 8 4.1 12.6 4.1s9.2-1.4 12.6-4.1l344.7-268.6c6.9-5.4 12.6-17 12.6-25.9V191.1c.2-8.8-6.6-18.3-14.9-21.2zM810 654.3L512 886.5 214 654.3V226.7l298-101.6 298 101.6v427.6zm-405.8-201c-3-4.1-7.8-6.6-13-6.6H336c-6.5 0-10.3 7.4-6.5 12.7l126.4 174a16.1 16.1 0 0026 0l212.6-292.7c3.8-5.3 0-12.7-6.5-12.7h-55.2c-5.1 0-10 2.5-13 6.6L468.9 542.4l-64.7-89.1z"}}]},name:"safety-certificate",theme:"outlined"};function v(){return v=Object.assign?Object.assign.bind():function(i){for(var l=1;l<arguments.length;l++){var r=arguments[l];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(i[n]=r[n])}return i},v.apply(this,arguments)}const W=(i,l)=>s.createElement(B,v({},i,{ref:l,icon:Q})),G=s.forwardRef(W),X=[{id:"1",name:"超级管理员",description:"拥有所有权限",memberCount:2,permissions:["*"],status:"active",createTime:"2024-01-01 09:00:00",isSystem:!0},{id:"2",name:"开发者",description:"可管理应用和配置",memberCount:5,permissions:["app:view","app:create","config:view","config:edit"],status:"active",createTime:"2024-01-10 10:30:00",isSystem:!1},{id:"3",name:"只读用户",description:"仅可查看数据",memberCount:10,permissions:["app:view","config:view","alert:view"],status:"inactive",createTime:"2024-01-15 14:20:00",isSystem:!1}],O={active:{text:"启用",color:"green"},inactive:{text:"禁用",color:"red"}},M=[{value:"active",label:"启用"},{value:"inactive",label:"禁用"}],{Search:Y}=S,ue=()=>{const[i,l]=s.useState(X),[r]=s.useState(!1),[n,w]=s.useState(""),[z,m]=s.useState(!1),[E,f]=s.useState(!1),[y,C]=s.useState(null),[x,V]=s.useState(null),[k,u]=s.useState([]),[h]=c.useForm(),T=[{title:"应用管理",key:"app",children:[{title:"查看应用",key:"app:view"},{title:"创建应用",key:"app:create"},{title:"编辑应用",key:"app:edit"},{title:"删除应用",key:"app:delete"}]},{title:"监控配置",key:"config",children:[{title:"查看配置",key:"config:view"},{title:"编辑配置",key:"config:edit"},{title:"发布配置",key:"config:publish"},{title:"回滚配置",key:"config:rollback"}]},{title:"告警管理",key:"alert",children:[{title:"查看告警",key:"alert:view"},{title:"创建规则",key:"alert:create"},{title:"编辑规则",key:"alert:edit"},{title:"处理告警",key:"alert:handle"}]},{title:"成员管理",key:"member",children:[{title:"查看成员",key:"member:view"},{title:"邀请成员",key:"member:invite"},{title:"编辑成员",key:"member:edit"},{title:"移除成员",key:"member:remove"}]},{title:"系统设置",key:"system",children:[{title:"查看设置",key:"system:view"},{title:"修改设置",key:"system:edit"},{title:"管理插件",key:"system:plugin"}]}],D=[{title:"角色名称",dataIndex:"name",key:"name",render:(e,a)=>t.jsxs(g,{children:[a.isSystem&&t.jsx(G,{style:{color:"#1890ff"}}),t.jsx("span",{style:{fontWeight:a.isSystem?"bold":"normal"},children:e}),a.isSystem&&t.jsx(p,{color:"blue",children:"系统"})]})},{title:"描述",dataIndex:"description",key:"description"},{title:"成员数量",dataIndex:"memberCount",key:"memberCount",render:e=>t.jsxs(p,{color:"green",children:[e," 人"]})},{title:"权限数量",key:"permissionCount",render:e=>t.jsxs(p,{color:"blue",children:[e.permissions.length," 项"]})},{title:"状态",dataIndex:"status",key:"status",render:e=>t.jsx(p,{color:O[e].color,children:O[e].text})},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:180},{title:"操作",key:"action",width:200,render:e=>t.jsxs(g,{size:"small",children:[t.jsx(d,{size:"small",onClick:()=>A(e),children:"查看权限"}),t.jsx(d,{size:"small",icon:t.jsx(H,{}),onClick:()=>L(e),disabled:e.isSystem,children:"编辑"}),t.jsx(d,{size:"small",danger:!0,icon:t.jsx(J,{}),onClick:()=>P(e.id),disabled:e.isSystem,children:"删除"})]})}],F=()=>{C(null),h.resetFields(),u([]),m(!0)},L=e=>{C(e),h.setFieldsValue(e),u(e.permissions),m(!0)},P=e=>{j.confirm({title:"删除角色",content:"确定要删除这个角色吗？删除后不可恢复。",onOk:()=>{l(i.filter(a=>a.id!==e)),b.success("删除成功")}})},A=e=>{V(e),u(e.permissions),f(!0)},$=()=>{h.validateFields().then(e=>{const a={...e,permissions:k};if(y)l(i.map(o=>o.id===y.id?{...o,...a}:o)),b.success("编辑成功");else{const o={id:Date.now().toString(),...a,memberCount:0,createTime:new Date().toLocaleString(),isSystem:!1};l([...i,o]),b.success("创建成功")}m(!1)})},R=i.filter(e=>e.name.includes(n)||e.description.includes(n));return t.jsxs(_,{children:[t.jsxs("div",{style:{marginBottom:16},children:[t.jsx(g,{style:{marginBottom:16},children:t.jsx(Y,{placeholder:"搜索角色名称、描述",allowClear:!0,style:{width:300},onSearch:w,onChange:e=>w(e.target.value)})}),t.jsx("div",{children:t.jsx(d,{type:"primary",icon:t.jsx(K,{}),onClick:F,children:"新建角色"})})]}),t.jsx(q,{columns:D,dataSource:R,rowKey:"id",loading:r,pagination:{total:R.length,pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`共 ${e} 条记录`}}),t.jsx(j,{title:y?"编辑角色":"新建角色",open:z,onOk:$,onCancel:()=>m(!1),width:700,children:t.jsxs(c,{form:h,layout:"vertical",children:[t.jsx(c.Item,{name:"name",label:"角色名称",rules:[{required:!0,message:"请输入角色名称"}],children:t.jsx(S,{placeholder:"请输入角色名称"})}),t.jsx(c.Item,{name:"description",label:"角色描述",rules:[{required:!0,message:"请输入角色描述"}],children:t.jsx(S.TextArea,{rows:3,placeholder:"请输入角色描述"})}),t.jsx(c.Item,{name:"status",label:"状态",initialValue:!0,valuePropName:"checked",children:t.jsx(N,{checkedChildren:M[0].label,unCheckedChildren:M[1].label})}),t.jsx(U,{children:"权限分配"}),t.jsx(I,{checkable:!0,defaultExpandAll:!0,treeData:T,checkedKeys:k,onCheck:e=>u(e)})]})}),t.jsx(j,{title:`角色权限 - ${x==null?void 0:x.name}`,open:E,onCancel:()=>f(!1),footer:[t.jsx(d,{onClick:()=>f(!1),children:"关闭"},"close")],width:600,children:t.jsx(I,{checkable:!0,defaultExpandAll:!0,treeData:T,checkedKeys:k,disabled:!0})})]})};export{ue as default};
