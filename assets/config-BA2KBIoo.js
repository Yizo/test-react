import{u as P,c as T,F as t,r as d,j as e,S as u,B as p,s as n,a as j,M as A}from"./index-C6T66UYw.js";import{C as S}from"./index-MJq_1bjb.js";import{R}from"./ArrowLeftOutlined-D6KmWXY3.js";import{S as f}from"./index-D3Omcvxu.js";import{D as y}from"./index-S__NQiOU.js";import{R as E}from"./SaveOutlined-zyCnrguJ.js";import{R as V}from"./ReloadOutlined-DY0v2jjP.js";import{S as g}from"./index-gul_2otK.js";import{T as q}from"./index-QvxEnahu.js";const{Option:F}=g,{TextArea:N}=j,z=()=>{const b=P(),{id:m}=T(),[a]=t.useForm(),[h,o]=d.useState(!1),[s,i]=d.useState(null);d.useEffect(()=>{const r={id:m||"1",name:"错误监控增强插件",description:"提供更详细的错误监控和分析功能，包括错误分类、趋势分析、自动建议等",version:"1.2.0",enabled:!0,settings:{enableAutoClassify:!0,maxErrorCount:1e3,reportInterval:60,alertThreshold:10,enableTrendAnalysis:!0,apiEndpoint:"https://api.example.com/errors",apiKey:"your-api-key-here",customRules:'error.type === "TypeError" && error.stack.includes("null")'},schema:[{key:"enableAutoClassify",label:"启用自动分类",type:"boolean",description:"自动对错误进行分类和聚合",defaultValue:!0},{key:"maxErrorCount",label:"最大错误数量",type:"number",required:!0,description:"单次上报的最大错误数量限制",defaultValue:1e3},{key:"reportInterval",label:"上报间隔(秒)",type:"number",required:!0,description:"错误数据上报的时间间隔",defaultValue:60},{key:"alertThreshold",label:"告警阈值",type:"number",required:!0,description:"触发告警的错误数量阈值",defaultValue:10},{key:"enableTrendAnalysis",label:"启用趋势分析",type:"boolean",description:"启用错误趋势分析功能",defaultValue:!0},{key:"apiEndpoint",label:"API端点",type:"string",required:!0,placeholder:"请输入API端点地址",description:"外部API服务的端点地址"},{key:"apiKey",label:"API密钥",type:"string",required:!0,placeholder:"请输入API密钥",description:"API访问密钥"},{key:"customRules",label:"自定义规则",type:"textarea",placeholder:"请输入自定义的错误处理规则",description:"使用JavaScript表达式定义自定义错误处理规则"}]};i(r),a.setFieldsValue(r.settings)},[m,a]);const v=async()=>{try{o(!0);const r=await a.validateFields();console.log("保存插件配置:",r),s&&i({...s,settings:r}),n.success("配置保存成功")}catch(r){console.error("保存失败:",r),n.error("配置保存失败")}finally{o(!1)}},k=()=>{A.confirm({title:"确认重置",content:"确定要重置所有配置为默认值吗？此操作不可恢复。",okText:"确认重置",cancelText:"取消",onOk:()=>{if(s){const r={};s.schema.forEach(l=>{l.defaultValue!==void 0&&(r[l.key]=l.defaultValue)}),a.setFieldsValue(r),n.success("配置已重置为默认值")}}})},I=async r=>{try{o(!0),console.log("切换插件状态:",r),s&&i({...s,enabled:r}),n.success(`插件已${r?"启用":"禁用"}`)}catch(l){console.error("操作失败:",l),n.error("操作失败")}finally{o(!1)}},C=r=>{var x;const l={name:r.key,label:r.label,rules:r.required?[{required:!0,message:`请输入${r.label}`}]:void 0,extra:r.description};switch(r.type){case"boolean":return e.jsx(t.Item,{...l,valuePropName:"checked",children:e.jsx(f,{})});case"number":return e.jsx(t.Item,{...l,children:e.jsx(q,{style:{width:"100%"},placeholder:r.placeholder})});case"select":return e.jsx(t.Item,{...l,children:e.jsx(g,{placeholder:r.placeholder,children:(x=r.options)==null?void 0:x.map(c=>e.jsx(F,{value:c.value,children:c.label},c.value))})});case"textarea":return e.jsx(t.Item,{...l,children:e.jsx(N,{rows:4,placeholder:r.placeholder})});default:return e.jsx(t.Item,{...l,children:e.jsx(j,{placeholder:r.placeholder})})}};return s?e.jsx("div",{className:"plugin-config-page",children:e.jsxs(S,{children:[e.jsxs("div",{className:"page-header",style:{marginBottom:24},children:[e.jsx(u,{children:e.jsx(p,{icon:e.jsx(R,{}),onClick:()=>b("/plugins"),children:"返回插件市场"})}),e.jsxs("div",{style:{marginTop:16},children:[e.jsx("h2",{children:s.name}),e.jsx("p",{style:{color:"#666",marginBottom:8},children:s.description}),e.jsxs(u,{children:[e.jsxs("span",{children:["版本: ",s.version]}),e.jsx(f,{checked:s.enabled,onChange:I,loading:h,checkedChildren:"启用",unCheckedChildren:"禁用"})]})]})]}),e.jsx(y,{}),e.jsxs(t,{form:a,layout:"vertical",disabled:!s.enabled,children:[e.jsx("div",{className:"config-form",children:s.schema.map(r=>e.jsx("div",{children:C(r)},r.key))}),e.jsx(y,{}),e.jsx("div",{className:"form-actions",children:e.jsxs(u,{children:[e.jsx(p,{type:"primary",icon:e.jsx(E,{}),onClick:v,loading:h,disabled:!s.enabled,children:"保存配置"}),e.jsx(p,{icon:e.jsx(V,{}),onClick:k,disabled:!s.enabled,children:"重置为默认值"})]})})]})]})}):e.jsx("div",{children:"加载中..."})};export{z as default};
